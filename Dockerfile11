FROM golang:1.22 AS builder

COPY . /src
WORKDIR /src

RUN go mod tidy
RUN go mod download

WORKDIR /src/cmd
RUN go build -o bin/main

COPY ./etc ./bin/etc
COPY ./swagger ./bin/swagger


FROM alpine:latest
COPY --from=builder /src/cmd/bin /app
WORKDIR /app
CMD ["./main", "-f", "etc/main.yaml"]
